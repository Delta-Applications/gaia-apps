'use strict';var fxaSelector={element:null,enabled:false,select:null,inProgress:false,init:function(){this.element=$('fxa-valueselector');},create:function(select){this.inProgress=true;this.select=select;if(null==this.element)
this.init();var combineValue=select.getAttribute('combineValue');var key=select.getAttribute('keyMatch');this.element.querySelector('ol').innerHTML='';var options=select.querySelectorAll('option');var index=0;for(var i in options){if(options[i]&&options[i].textContent){var li=document.createElement('li');li.setAttribute('role','option');li.setAttribute('value',options[i].value);li.setAttribute('l10nid',options[i].getAttribute('data-l10n-id'));var span=document.createElement('span');span.textContent=options[i].textContent;if(combineValue){span.textContent=options[i].textContent+' '+options[i].value;}
var label=document.createElement('label');label.setAttribute('role','presentation');label.appendChild(span);li.appendChild(label);if(key){li.setAttribute(key,options[i].getAttribute(key));if(select.getAttribute(key)===options[i].getAttribute(key)){li.setAttribute('aria-selected','true');NavigationMap.setDialogFocusIndex(index);}}else{if(select.value===options[i].value){li.setAttribute('aria-selected','true');NavigationMap.setDialogFocusIndex(index);}}
this.element.querySelector('ol').appendChild(li);index++;}}
this.element.querySelector('h3').textContent=lget('select');var trackClass=select.getAttribute('data-track-class');if(trackClass){var hSpan=document.querySelector('.'+trackClass);if(hSpan&&hSpan.textContent)
this.element.querySelector('h3').textContent=hSpan.textContent;}
this.show();},show:function(){var self=this;this.element.classList.remove('hidden');setTimeout(function(){self.enabled=true;self.inProgress=false;},300);},destroy:function(){var self=fxaSelector;self.inProgress=false;self.element.classList.add('hidden');self.enabled=false;NavigationMap.setDialogFocusIndex(0);},cancel:function(){var self=fxaSelector;self.destroy();},done:function(){var self=fxaSelector;if(!self.enabled)return;var selected=self.element.querySelector('ol li.focus');self.select.value=selected.getAttribute('value');var p={};p.l10nId=selected.getAttribute('l10nid');p.value=selected.getAttribute('value');var evt=new CustomEvent('change',{detail:p,bubbles:true,cancelable:false});var key=self.select.getAttribute('keyMatch');if(key){self.select.setAttribute(key,selected.getAttribute(key))}
self.select.dispatchEvent(evt);self.destroy();}};