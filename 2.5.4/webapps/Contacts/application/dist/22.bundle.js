webpackJsonp([22],{288:function(t,exports,e){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function n(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var u=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),c=e(3),s=a(c),l=e(10),f=a(l),d=e(5),p=a(d),h=e(21),y=a(h),g=e(4),v=a(g),b=e(24),m=a(b),k=e(48),w=a(k),C=e(11),_=a(C),q=e(83),D=a(q),P=e(25),E=a(P),O=function(t){function e(t){o(this,e);var a=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));a.FOCUS_SELECTOR=".list-item";var n=a.props.name,r=a.props.id;return a.group={id:r,name:n},a.state={contacts:_.default.getContactsByGroupID(r)},a.isPicker=v.default.query("isActivity"),a.activityData=v.default.query("activityData"),a}return r(e,t),u(e,[{key:"componentDidMount",value:function(){var t=this,e=this.getConfig();this.element=f.default.findDOMNode(this),this._softKey=y.default.create(this.element,e),this.onContactChanged=function(){t.setState({contacts:_.default.getContactsByGroupID(t.group.id)})},_.default.on("changed",this.onContactChanged),this.navigator=new m.default(this.FOCUS_SELECTOR,this.element)}},{key:"componentDidUpdate",value:function(){this.updateSoftKeys()}},{key:"componentWillUnmount",value:function(){this._softKey.destroy(),_.default.off("changed",this.onContactChanged)}},{key:"getConfig",value:function(){var t=!!this.state.contacts.length;return this.isPicker?{left:"",center:t?"select":"",right:t?"view":""}:{left:"add",center:t?"select":"",right:t?"options":""}}},{key:"updateSoftKeys",value:function(){this._softKey.update(this.getConfig())}},{key:"updateGroupContacts",value:function(t){var e=this,a=t?t.map(function(t){return t}):[],n=0;a.forEach(function(t){"duplicate"===_.default.contactAddGroup(t,e.group)&&n++}),n&&v.default.request("ToastManager:show",{text:navigator.mozL10n.get("duplicate-removed")})}},{key:"onKeyDown",value:function(t){var e=this,a=document.activeElement.dataset.id,o=null;a&&(o=_.default.getContactSync(a));var i=void 0,r="",u=[];switch(t.key){case"Call":if(!o)break;if(this.isPicker)break;v.default.request("pickANumber",o).then(function(t){E.default.dial(t)});break;case"Backspace":t.preventDefault(),t.stopPropagation(),v.default.request("back");break;case"SoftRight":if(t.preventDefault(),t.stopPropagation(),!o)break;if(this.isPicker){i=t.target.querySelector("a"),r=i.pathname,v.default.request("push",r);break}u=u.concat(D.default.optionsForContact(o),{id:"massive-delete",callback:function(){v.default.request("back"),v.default.request("back"),v.default.request("setEditMode","delete")}},{id:"settings",callback:function(){v.default.request("push","/setting")}}),v.default.request("showOptionMenu",{options:u});break;case"Enter":if(!a)break;i=t.target.querySelector("a"),r=i.pathname,this.isPicker?v.default.request("pick",a):v.default.request("push",r),t.preventDefault(),t.stopPropagation();break;case"SoftLeft":if(t.preventDefault(),t.stopPropagation(),this.isPicker)break;v.default.request("push","/pick/group",{id:this.group.id,name:this.group.name,noSimContact:!0,source:"phone"}).then(function(t){e.updateGroupContacts.apply(e,n(t))})}}},{key:"onFocus",value:function(){this.updateSoftKeys()}},{key:"render",value:function(){var t=this,e=this.group.name;this.isPicker&&(e=navigator.mozL10n.get("select-a-contact"));var a=this.state.contacts;if(this.activityData.type)switch(this.activityData.type){case"webcontacts/select":a=this.state.contacts.filter(function(t){return t.tel&&t.tel.length||t.email&&t.email.length});break;case"webcontacts/tel":a=this.state.contacts.filter(function(t){return t.tel&&t.tel.length});break;case"webcontacts/email":a=this.state.contacts.filter(function(t){return t.email&&t.email.length})}return s.default.createElement("div",{className:"group-view list-view",tabIndex:"-1",onKeyDown:function(e){return t.onKeyDown(e)},onFocus:function(e){return t.onFocus(e)}},s.default.createElement("div",{className:"header h1 group-view-header"},e),s.default.createElement("div",{className:"body"},s.default.createElement(w.default,{contacts:a})))}}]),e}(p.default);exports.default=O}});
//# sourceMappingURL=22.bundle.js.map