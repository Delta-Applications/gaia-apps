webpackJsonp([21],{289:function(e,exports,t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),c=t(3),l=a(c),s=t(10),u=a(s),d=t(5),f=a(d),m=t(21),p=a(m),v=t(4),h=a(v),y=t(24),E=a(y),b=t(131),g=a(b),w=t(11),C=a(w),k=function(e){function t(e){n(this,t);var a=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.FOCUS_SELECTOR=".list-item.navigable",a.state={contacts:g.default.getAll()},a}return o(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this;window.icv=this;var t=this.getConfig();this.element=u.default.findDOMNode(this),this.navigator=new E.default(this.FOCUS_SELECTOR,this.element),this._softKey=p.default.create(this.element,t),this.store=g.default,this.onChanged=function(){e.setState({contacts:g.default.getAll()})},g.default.on("changed",this.onChanged)}},{key:"componentWillUnmount",value:function(){this._softKey.destroy(),g.default.off("changed",this.onChanged)}},{key:"componentDidUpdate",value:function(){this.updateSoftKeys()}},{key:"getConfig",value:function(){var e=document.activeElement.dataset.id,t={};return e?t.right="remove":Number.isNaN(document.activeElement.dataset.index)||(t.center="select"),t}},{key:"updateSoftKeys",value:function(){this._softKey.update(this.getConfig())}},{key:"onKeyDown",value:function(e){var t=+document.activeElement.dataset.index,a=document.activeElement.dataset.id;switch(e.key){case"Enter":if(!a){var n=new MozActivity({name:"pick",data:{type:"webcontacts/ice",params:{typeOfContact:"device"}}});n.onsuccess=function(){var e=n.result.id;if(e){var a=n.result.tel[0].value;g.default.setContact(e,a,t)}}}break;case"Backspace":e.preventDefault(),e.stopPropagation(),h.default.request("back");break;case"SoftRight":a&&h.default.request("showDialog",{type:"confirm",header:"confirm",content:"delete-ice-contact-warning",ok:"remove",onOk:function(){g.default.unsetContact(t)}})}}},{key:"render",value:function(){var e=this,t=[];return this.state.contacts.forEach(function(e,a){var n=JSON.stringify({n:a+1}),i="ice"+a;t.push(l.default.createElement("div",{className:"separator secondary","data-l10n-id":"ICEContact","data-l10n-args":n,key:i+"Separator"}));var o=null;if(e.id){var r=C.default.contactMap.get(e.id);o=l.default.createElement("div",{className:"primary"},l.default.createElement("div",{className:"primary"},r.name[0]||e.number))}else o=l.default.createElement("div",{className:"content"},l.default.createElement("div",{className:"primary"},l.default.createElement("span",{"data-l10n-id":"ICESelectContact"})));t.push(l.default.createElement("div",{className:"list-item navigable",tabIndex:"-1","data-index":a,"data-id":e.id,key:i},o))}),l.default.createElement("div",{id:"ice-editor-view",tabIndex:"-1",onKeyDown:function(t){return e.onKeyDown(t)},onFocus:function(){return e.updateSoftKeys()}},l.default.createElement("div",{className:"header h1","data-l10n-id":"ICESettingTitle"}),l.default.createElement("div",{className:"body"},l.default.createElement("div",{className:"list-item","data-multi-line":"true"},l.default.createElement("div",{className:"content"},l.default.createElement("div",{className:"primary","data-l10n-id":"ICEDescription"}))),t))}}]),t}(f.default);exports.default=k}});
//# sourceMappingURL=21.bundle.js.map